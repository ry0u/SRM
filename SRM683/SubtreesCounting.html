<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>
You are given an undirected tree T.
(The input format is specified below.)
The vertices of the tree are numbered 0 through <b>n</b>-1.
</p>

<p>
A subtree of T is any subgraph of T that is connected.
The size of a subtree is the number of vertices it contains.
Two subtrees are considered different if one of them contains a vertex the other doesn't.
</p>

<p>
Let X be the sum of sizes of all subtrees of T.
As X can be large, compute and return the value (X modulo 1,000,000,007).
</p>

<p>
You are given the int <b>n</b>: the size of tree T.
You are also given parameters for a pseudorandom generator: ints <b>a0</b>, <b>b</b>, <b>c</b>, and <b>m</b>.
Use the pseudocode given below to generate the tree T.
Watch out for integer overflow.
</p>

<pre>
a[0] = a0
for i = 1 .. n-2:
    a[i] = (b * a[i-1] + c) mod m

for i = 1 .. n-1:
    j = a[i-1] mod i
    add an edge between vertices i and j
</pre></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>SubtreesCounting</td></tr><tr><td>Method:</td><td>sumOfSizes</td></tr><tr><td>Parameters:</td><td>int, int, int, int, int</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int sumOfSizes(int n, int a0, int b, int c, int m)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>n</b> will be between 1 and 10^5, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>a0</b>, <b>b</b> and <b>c</b> will be between 0 and 10^9, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>m</b> will be between 1 and 10^9, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>3</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 10</pre></td></tr><tr><td><table><tr><td colspan="2">Tree T has 3 vertices and contains the edges 0-1 and 0-2.
This tree has six different subtrees.
These correspond to the following sets of vertices: {0}, {1}, {2}, {0,1}, {0,2}, and {0,1,2}.
The sizes of these subtrees are 1, 1, 1, 2, 2, and 3.
Thus, the correct answer is 1+1+1+2+2+3 = 10.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>100</pre></td></tr></table></td></tr><tr><td><pre>Returns: 52</pre></td></tr><tr><td><table><tr><td colspan="2">Tree T contains the edges 0-1, 1-2, 1-3, 1-4.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2">Just one vertex in T.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>2</pre></td></tr><tr><td><pre>5</pre></td></tr><tr><td><pre>6</pre></td></tr><tr><td><pre>7</pre></td></tr><tr><td><pre>8</pre></td></tr></table></td></tr><tr><td><pre>Returns: 4</pre></td></tr><tr><td><table><tr><td colspan="2">Tree T has 2 vertices and contains the only edge 0-1.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>100000</pre></td></tr><tr><td><pre>123</pre></td></tr><tr><td><pre>46645</pre></td></tr><tr><td><pre>4564579</pre></td></tr><tr><td><pre>1000000000</pre></td></tr></table></td></tr><tr><td><pre>Returns: 769840633</pre></td></tr><tr><td><table><tr><td colspan="2">Watch out for integer overflow.
First 10 elements (a[0], a[1], ..., a[9]) of the generated sequence are:<br></br>
123, 10301914, 537343109, 373883884, 818333759, 182753134, 524500009, 307484384, 613656259, 765634.</td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
