<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>
<i>This problem statement contains superscripts that may not display correctly in some plugins. If that's the case, use the arena to see them.</i>
</p><p>
You have recently bought a game of extended dominoes.  Each domino is a rectangle partitioned into two squares, and each square contains a number between 0 and 9, inclusive.  There are exactly 45 pieces - one for each pair of distinct numbers.  Pieces may be reversed, so while there is only one piece containing the numbers 1 and 2, it can be used in either of the following ways:
</p><pre>
   +---+---+     +---+---+
   | 1 | 2 |     | 2 | 1 |
   +---+---+     +---+---+
</pre><p>
Unfortunately, some of the pieces have disappeared, but there is still a possible game left: <i>How many ways are there to construct a cycle collection with all the remaining pieces?</i>
</p><p>
A cycle collection is a set of 1 or more cycles that do not share pieces.  A cycle is constructed by ordering and orienting the pieces in such a way that the left number of the piece in position i is equal to the right number of the piece in position i-1, and the left number of the piece in the first position is equal to the right number of the piece in the last position (positions are numbered from left to right).
</p><pre>
   +---+---++---+---++---+---++---+---++---+---++---+---+
   | 1 | 2 || 2 | 5 || 5 | 4 || 4 | 2 || 2 | 8 || 8 | 1 |   
   +---+---++---+---++---+---++---+---++---+---++---+---+

   +---+---++---+---++---+---++---+---++---+---++---+---+
   | 1 | 2 || 2 | 4 || 4 | 5 || 5 | 2 || 2 | 8 || 8 | 1 |   
   +---+---++---+---++---+---++---+---++---+---++---+---+

   +---+---++---+---++---+---+  +---+---++---+---++---+---+
   | 1 | 2 || 2 | 8 || 8 | 1 |  | 4 | 5 || 5 | 2 || 2 | 4 |   
   +---+---++---+---++---+---+  +---+---++---+---++---+---+
</pre><p>
The figure above shows three possible cycle collections that use the same set of pieces.  We say that each piece is connected to the two pieces that surround it, and the first and last pieces are also connected.  Two cycles are considered the same if each piece is connected to the same two other pieces in both cycles.  Two cycle collections are the same if they contain the same set of cycles.
</p><p>
You will be given the existing pieces as a vector &lt;string&gt; <b>pieces</b>, where each element contains exactly two digits representing the two numbers on a single domino.  Return the number of distinct cycle collections that can be formed with these pieces.
</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>ExtendedDominoes</td></tr><tr><td>Method:</td><td>countCycles</td></tr><tr><td>Parameters:</td><td>vector &lt;string&gt;</td></tr><tr><td>Returns:</td><td>long long</td></tr><tr><td>Method signature:</td><td>long long countCycles(vector &lt;string&gt; pieces)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>64</td></tr></table></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>Remember that each cycle collection must use all the pieces, and no two cycles in a collection can share pieces.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>pieces</b> will contain between 1 and 45 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>pieces</b> will contain exactly 2 characters.</td></tr><tr><td align="center" valign="top">-</td><td>Each character of each element of <b>pieces</b> will be a digit ('0'-'9').</td></tr><tr><td align="center" valign="top">-</td><td>In each element of <b>pieces</b> the value of its first character will be less than the value of its second character.</td></tr><tr><td align="center" valign="top">-</td><td>No two elements of <b>pieces</b> will be equal.</td></tr><tr><td align="center" valign="top">-</td><td>The number of cycles for <b>pieces</b> will be less than 2<sup>63</sup>.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;12&quot;,&quot;25&quot;,&quot;45&quot;,&quot;24&quot;,&quot;28&quot;,&quot;18&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 3</pre></td></tr><tr><td><table><tr><td colspan="2">The example in the problem statement.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;01&quot;,&quot;12&quot;,&quot;23&quot;,&quot;34&quot;,&quot;45&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2">There is no way to form a cycle here.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;09&quot;,&quot;12&quot;,&quot;24&quot;,&quot;14&quot;,&quot;57&quot;,&quot;79&quot;,&quot;05&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2">The only possibility is:
<pre>
   +---+---++---+---++---+---++---+---+  +---+---++---+---++---+---+
   | 0 | 9 || 9 | 7 || 7 | 5 || 5 | 0 |  | 1 | 2 || 2 | 4 || 4 | 1 |   
   +---+---++---+---++---+---++---+---+  +---+---++---+---++---+---+
</pre></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;34&quot;,&quot;35&quot;,&quot;36&quot;,&quot;37&quot;,&quot;45&quot;,&quot;46&quot;,&quot;47&quot;,&quot;56&quot;,&quot;57&quot;,&quot;67&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 243</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
