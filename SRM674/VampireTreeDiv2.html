<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>You are a genealogist specializing in family trees of vampires. Vampire family trees differ from human family trees. In particular, there are two ways how a vampire can be "born":</p>

<ol>
<li>A living human can be turned into a vampire (the technical term here is "sired") by an existing vampire. In this case we call the older vampire the master and the newly created vampire the servant of that master.</li>
<li>Two existing vampires can have a vampire child. In this case we call the two original vampires parents and the new vampire their child. Note that there are no restrictions on the two parent vampires. In particular, their genders and their ancestry can be arbitrary. Any two vampires can have a child.</li>
</ol>

<p>You are now studying one particular family of vampires. These vampires have all been created from a single vampire: the True Ancestor. This special vampire has no master and no parents. There are n vampires in the family. They are numbered 0 through n-1 in the order in which they were born, with vampire 0 being the True Ancestor.</p>

<p>You are given a description of the family tree in the vector &lt;int&gt;s <b>A</b> and <b>B</b>, each with n-1 elements. For each i between 1 and n-1, inclusive, the values <b>A</b>[i-1] and <b>B</b>[i-1] describe either the master or the parents of vampire i. If vampire i has a master then <b>A</b>[i-1] will be the number of its master and <b>B</b>[i-1] will be equal to -1. Otherwise, <b>A</b>[i-1] and <b>B</b>[i-1] will be the numbers of the two parents of vampire i.</p>

<p>In this particular family it is pretty rare for two vampires to have a child. More precisely, there are at most 15 vampires with two parents each.</p>

<p>You would like to select a representative sample of vampires from this family. The sample must have the following properties:</p>
<ul>
<li>You need to select at least one vampire from each master/servant and also from each parent/child relationship.</li>
<li>The total number of vampires in your sample must be as small as possible.</li>
</ul>

<p>Find and return the number of ways in which you can select the sample, modulo 10^9+7.</p>
</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>VampireTreeDiv2</td></tr><tr><td>Method:</td><td>countMinSamples</td></tr><tr><td>Parameters:</td><td>vector &lt;int&gt;, vector &lt;int&gt;</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int countMinSamples(vector &lt;int&gt; A, vector &lt;int&gt; B)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>4.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>Please pay attention to the unusual time limit.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>A</b> will contain between <b>1</b> and <b>999</b> elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>A</b> and <b>B</b> will contain the same number of elements.</td></tr><tr><td align="center" valign="top">-</td><td>There are no more than <b>15</b> elements of <b>B</b> that are not equal to <b>-1</b>.</td></tr><tr><td align="center" valign="top">-</td><td><b>0 &lt;= A[i] &lt;= i</b> for all valid <b>i</b>.</td></tr><tr><td align="center" valign="top">-</td><td><b>-1 &lt;= B[i] &lt;= i</b> for all valid <b>i</b>.</td></tr><tr><td align="center" valign="top">-</td><td><b>A[i] != B[i]</b> for all valid <b>i</b>.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0}</pre></td></tr><tr><td><pre>{-1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2"><p>There are two vampires.
The True Ancestor (vampire 0) is the master of vampire 1.
As vampires 0 and 1 are in a master/servant relationship, we are required to select at least one of them.</p>

<p>There are two valid samples.
One of them is {0} and the other is {1}.
The sample {0, 1} is not a valid sample because it contains too many vampires.</p>
</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0, 1}</pre></td></tr><tr><td><pre>{-1, 0}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 3</pre></td></tr><tr><td><table><tr><td colspan="2"><p>In this test case there are three vampires.
As in Example 0, vampire 0 is the master of vampire 1.
Then, vampires 1 and 0 are the parents of vampire 2.</p>

<p>According to the problem statement:</p>
<ul>
<li>Vampires 0 and 1 are in a master/servant relationship, so we have to select at least one of them.</li>
<li>Vampires 0 and 2 are in a parent/child relationship, so we have to select at least one of them.</li>
<li>Vampires 1 and 2 are in a parent/child relationship, so we have to select at least one of them.</li>
</ul>

<p>Clearly, this means we have to select at least two vampires.
On the other hand, we can easily verify that each of the 3 samples {0, 1}, {0, 2}, and {1, 2} is valid.</p>
</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0, 0, 2, 2}</pre></td></tr><tr><td><pre>{-1, -1, -1, -1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0, 1, 2, 3}</pre></td></tr><tr><td><pre>{-1, -1, -1, -1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0, 1, 1, 2, 1, 2, 2, 5, 7, 6, 5, 10, 6, 6, 12, 6, 6, 2, 8, 0, 16, 5, 8, 2, 14}</pre></td></tr><tr><td><pre>{-1, -1, -1, -1, 0, -1, -1, -1, 2, 7, 10, 11, 7, 9, -1, 5, -1, 15, 4, 7, 9, -1, 13, 6, 24}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 78</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">5)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{0,1,0,3,0,5,0,7,0,9,0,11,0,13,0,15,0,17,0,19,0,21,0,23,0,25,0,27,0,29,0,31,0,33,0,35,0,37,0,39,0,41,0,43,0,45,0,47,0,49,0,51,0,53,0,55,0,57,0,59,0}</pre></td></tr><tr><td><pre>{-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 73741818</pre></td></tr><tr><td><table><tr><td colspan="2"><p>The answer is 1073741825 mod 10^9+7 which is 73741818.</p></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
